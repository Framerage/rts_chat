import{importShared as M}from"./__federation_fn_import.js";var p={exports:{}},u={};var m;function E(){if(m)return u;m=1;var i=Symbol.for("react.transitional.element"),x=Symbol.for("react.fragment");function a(d,e,s){var r=null;if(s!==void 0&&(r=""+s),e.key!==void 0&&(r=""+e.key),"key"in e){s={};for(var o in e)o!=="key"&&(s[o]=e[o])}else s=e;return e=s.ref,{$$typeof:i,type:d,key:r,ref:e!==void 0?e:null,props:s}}return u.Fragment=x,u.jsx=a,u.jsxs=a,u}var k;function W(){return k||(k=1,p.exports=E()),p.exports}var n=W();const C="_contentWrap_1exkb_1",w="_chatContainer_1exkb_9",T="_chatHeader_1exkb_19",b="_chatWindow_1exkb_25",N="_chatMsg_1exkb_37",$="_personMsg_1exkb_40",F="_chatFooter_1exkb_44",l={contentWrap:C,chatContainer:w,chatHeader:T,chatWindow:b,chatMsg:N,personMsg:$,chatFooter:F},{useCallback:H,useEffect:g,useRef:v,useState:_}=await M("react"),q=()=>{const[i,x]=_([]),[a,d]=_(),[e,s]=_(),r=v(null),o=v(null);g(()=>{const t=new WebSocket("ws://localhost:8080");return s(t),t.onopen=c=>{console.log("connection ",c);const h=new Date().getMilliseconds();r.current=h},t.onmessage=c=>{console.log(c," msg event");const h=String(c.data),j=h.split("//c:")[0],R=h.split("//c:")[1];x(f=>[...f,{value:j,client:R,timeStamp:new Date().toLocaleTimeString()}])},t.onclose=c=>{console.log("closed ",c)},t.onerror=c=>{console.log("socket error ",c)},()=>{t.close()}},[]);const S=H(()=>{a&&e&&e.readyState===WebSocket.OPEN&&(e.send(`${a.replaceAll(/^\n+|\n|\r+$/g,"")}//c:${r.current}`),d(""))},[a,e,r]);return console.log(i," msgs",e),g(()=>{i.length!==0&&o?.current?.scrollTo(0,o?.current?.scrollHeight)},[o,i]),n.jsx("main",{className:l.contentWrap,children:n.jsxs("section",{className:l.chatContainer,children:[n.jsx("div",{className:l.chatHeader,children:"Room"}),n.jsx("ul",{className:l.chatWindow,ref:o,children:i.map(t=>n.jsxs("li",{className:`${l.chatMsg} ${t.client===String(r.current)&&l.personMsg}`,children:[n.jsx("p",{children:t.value}),n.jsx("p",{children:t.timeStamp.slice(0,-3)}),n.jsx("p",{children:t.client})]},t.timeStamp))}),n.jsxs("div",{className:l.chatFooter,children:[n.jsx("textarea",{onChange:t=>d(t.currentTarget.value),value:a}),n.jsx("button",{onClick:S,children:"Send"})]})]})})};export{q as default,n as j};
